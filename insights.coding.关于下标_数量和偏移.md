---
id: zx6sonujtlizj4wj15fauno
title: 关于下标_数量和偏移
desc: ''
updated: 1740509619821
created: 1740504867501
---

下标索引和计数，都会涉及数组的访问等。

## 左闭右开区间探究

### 数量关系：两个下标确定区间，作差

左闭右开的区间表示中，开区间部分减去起始，代表元素数量。下标之间作差，得到是对应区间长度，而非直接的元素数量。我们可以形象地理解，两个下标由箭头来连接，把连接的左侧下标作为锚点，作为计数的依据。有多少的箭头，就有多少个左侧锚点，有多少个左侧元素。而左闭右开，恰好与不计入右侧的思路来契合。所以，开区间右侧减去闭区间左侧，得到箭头的数量，得到左侧下标点数量，即元素数量。如图的 3 - 0 代表由 0, 1, 2 下标制定的元素。

```
   │     │     │         
   │◄─── │◄─── │◄─── │   
   └─────┴─────┴─────┴───
  [0     1     2     3)  
```

推广，也可把小箭头缩放，代表两个、四个等，在归并算法、二分查找时也有用。当索引由右向左索引时，思路类似。

找数量时，需要对区间下标作差。元素数量代表数轴下标锚点的数量，但区间作差得到的是长度，所以用箭头的指向来计算，辅助记忆。

### 偏移关系：一个下标，增加偏移

找目标点的下标时，需要求和，添加偏移，offset。与求数量执行的操作相反。offset 是区间长度，箭头的数量，可以先转换到数量的问题，再确定 offset 应该是多少。

需要确定目标点相对当前点的偏移是多少。比如，offset 为 3，目标点 j = i + offset，于是左闭右开区间 [i, j) 确定的元素数量为 3，j 为 3。想像添加偏移后的目标点，它在左闭右开区间的右开区间点，而添加的 offset 个箭头，每个都指向左侧下标锚点。因此，端点 j 总在区间右开部分。

#### 从右侧寻找左侧下标

首先，确定偏移数量。从右侧寻找，将加法变为减法。想像 i 为左开右闭的右侧边界点，offset 对应指向右侧箭头的数量。于是，**确定偏移量抽象为确定区间 (j, i] 问题，j = i - offset，确定一闭一开区间时，当其中一侧边界点确定后，便可转换问题为确定区间包含元素数量的问题**。

比如，当前下标 i = 3，以下标 2 为结尾的子区间有两个元素，即 num_span = 2。需要找到与 i 一起形成边界的区间下标，把此子区间包围。也就是 (j, i] 要包含此子区间，并且 j 是子区间的左侧相邻。即 (0, 3]，但是 offset 如何计算？答案：left = i - num_span - 1。

理解：任务需要确定 offset。首先，**确定区间包含元素数量**。题目要求包含子区间，对应下标 1 和 2 两个元素。再计入 i 本身，因为偏移确定的点是开区间的边界点，不计入元素。所以，左开右闭区间一共有三个元素。元素数量已经确定，需要有 3 个向右的箭头指向各自元素下标锚点。固 offset 为 3。左侧开区间边界点为 j = i - 3。offset 代表 num_span + 1，包含区间元素数量和一个右边界点。

## 提问 DeepSeek

Q：写代码时，有时候我会弄混下标的 offset 与 数量的关系，比如下标之间作差表示区间长度，而非区间上下标的数量，关于这些部分，该如何理解，也可做补充，以更好理解

## Ref and Tag

[[insights.工程能力]]

#Coding